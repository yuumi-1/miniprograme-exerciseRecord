<view class="page">
  <!-- 返回按钮 -->
  <t-navbar title="添加记录" left-arrow />
  <!-- 锻炼项目列表 -->
  <scroll-view class="workout-list" scroll-y="true">
    <!-- 顶部日期和单位选择器 -->
    <view class="header-section">
    <view class="header-item">
      <text class="header-label">日期</text>
      <picker mode="date" value="{{date}}" bindchange="bindDateChange">
        <view class="picker-value">{{date}}</view>
      </picker>
    </view>
    <view class="header-item">
      <text class="header-label">重量单位</text>
      <picker mode="selector" value="{{unitIndex}}" bindchange="bindUnitChange" range="{{units}}">
        <view class="picker-value">{{units[unitIndex]}}</view>
      </picker>
    </view>
  </view>
    <!-- 深蹲 -->
    <view class="workout-item">
      <view class="workout-title">Squat</view>
      <view class="sets-container">
        <view class="set-item" wx:for="{{squatSets}}" wx:key="index">
          <input type="digit" placeholder="重量" 
                 value="{{item.weight}}" 
                 bindinput="bindSquatWeightChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text class="unit-text">{{units[unitIndex]}}</text>
          <input type="digit" placeholder="次数" 
                 value="{{item.reps}}" 
                 bindinput="bindSquatRepsChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text>次</text>
          <view wx:if="{{squatSets.length === 1}}" bindtap="addSet" data-type="squat">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:elif="{{index === squatSets.length - 1}}" bindtap="addSet" data-type="squat">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:else bindtap="deleteSet" data-type="squat" data-index="{{index}}">
            <mp-icon icon="delete" color="#CC0000" size="{{25}}"></mp-icon>
          </view>
        </view>
      </view>
    </view>

    <!-- 硬拉 -->
    <view class="workout-item">
      <view class="workout-title">Deadlift</view>
      <view class="sets-container">
        <view class="set-item" wx:for="{{deadliftSets}}" wx:key="index">
          <input type="digit" placeholder="重量" 
                 value="{{item.weight}}" 
                 bindinput="bindDeadliftWeightChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text class="unit-text">{{units[unitIndex]}}</text>
          <input type="digit" placeholder="次数" 
                 value="{{item.reps}}" 
                 bindinput="bindDeadliftRepsChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text>次</text>
          <view wx:if="{{deadliftSets.length === 1}}" bindtap="addSet" data-type="deadlift">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:elif="{{index === deadliftSets.length - 1}}" bindtap="addSet" data-type="deadlift">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:else bindtap="deleteSet" data-type="deadlift" data-index="{{index}}">
            <mp-icon icon="delete" color="#CC0000" size="{{25}}"></mp-icon>
          </view>
        </view>
      </view>
    </view>

    <!-- 卧推 -->
    <view class="workout-item">
      <view class="workout-title">Benchpress</view>
      <view class="sets-container">
        <view class="set-item" wx:for="{{benchpressSets}}" wx:key="index">
          <input type="digit" placeholder="重量" 
                 value="{{item.weight}}" 
                 bindinput="bindBenchpressWeightChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text class="unit-text">{{units[unitIndex]}}</text>
          <input type="digit" placeholder="次数" 
                 value="{{item.reps}}" 
                 bindinput="bindBenchpressRepsChange" 
                 data-index="{{index}}"
                 cursor-spacing="100"/>
          <text>次</text>
          
          <view wx:if="{{benchpressSets.length === 1}}" bindtap="addSet" data-type="benchpress">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:elif="{{index === benchpressSets.length - 1}}" bindtap="addSet" data-type="benchpress">
            <mp-icon type="field" icon="add" color="#3D9970" size="{{25}}"></mp-icon>
          </view>
          <view wx:else bindtap="deleteSet" data-type="benchpress" data-index="{{index}}">
            <mp-icon icon="delete" color="#CC0000" size="{{25}}"></mp-icon>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
  <!-- 底部保存按钮 -->
  <view class="save-button-container">
    <button class="save-button" bindtap="saveAndBack">
      <text>保存</text>
    </button>
  </view>
</view>    